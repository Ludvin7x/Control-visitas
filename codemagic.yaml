workflows:
  android-release:
    name: Build Android Release APK
    max_build_duration: 60
    environment:
      groups:
        - firebase
        - signing
      vars:
        GRADLE_TASK: assembleRelease
        KEYSTORE_PATH: keystore.jks
    scripts:
      - echo "üîì Decodificando keystore..."
      - echo $KEYSTORE_BASE64 | base64 --decode > $KEYSTORE_PATH
      - echo "üõ†Ô∏è Otorgando permisos..."
      - chmod +x ./gradlew
      - echo "üöÄ Iniciando compilaci√≥n..."
      - ./gradlew $GRADLE_TASK \
          -Pandroid.injected.signing.store.file=$KEYSTORE_PATH \
          -Pandroid.injected.signing.store.password=$KEYSTORE_PASSWORD \
          -Pandroid.injected.signing.key.alias=$KEY_ALIAS \
          -Pandroid.injected.signing.key.password=$KEY_PASSWORD
      - echo "‚úÖ APK compilado, listando archivos..."
      - find app/build/outputs/apk/
    artifacts:
      - app/build/outputs/apk/release/app-release.apk
